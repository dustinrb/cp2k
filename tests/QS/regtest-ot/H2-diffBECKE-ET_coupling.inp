&GLOBAL
  PRINT_LEVEL MEDIUM
  PROJECT H2-diffBECKE-ET_coupling
  RUN_TYPE ENERGY
&END GLOBAL

&MOTION
  &MD
    ENSEMBLE NVE
    STEPS 2
    TEMPERATURE 300.0
    TIMESTEP 0.2
  &END MD
&END MOTION

! Mixed force_eval for CDFT coupling
&MULTIPLE_FORCE_EVALS
  FORCE_EVAL_ORDER 2 3
  MULTIPLE_SUBSYS F
&END MULTIPLE_FORCE_EVALS

&FORCE_EVAL
  METHOD MIXED
  &MIXED
    MIXING_TYPE MIXED_CDFT
    NGROUPS 1
    &MIXED_CDFT
      COUPLING 1
      LAMBDA 0.0
    &END MIXED_CDFT
    &PRINT
      &PROGRAM_RUN_INFO
      &END PROGRAM_RUN_INFO
    &END PRINT
  &END MIXED
  &SUBSYS
    &CELL
      ABC 3.00 3.0 3.0
    &END CELL
    &COORD
      H        -3.0000065198  0.0  0.0
      H         -4.03001433862  0.0 0.0
    &END COORD
    &KIND C
      BASIS_SET DZVP-GTH-BLYP
      POTENTIAL GTH-PADE-q4
    &END KIND
    &KIND H
      BASIS_SET DZVP-GTH-BLYP
      POTENTIAL GTH-PADE-q1
    &END KIND
    &KIND O
      BASIS_SET DZVP-GTH-BLYP
      POTENTIAL GTH-PADE-q6
    &END KIND
  &END SUBSYS
&END FORCE_EVAL

! Force_eval A
&FORCE_EVAL
  METHOD Quickstep
  &DFT
    BASIS_SET_FILE_NAME BASIS_SET
    POTENTIAL_FILE_NAME POTENTIAL
    UKS
    &MGRID
      CUTOFF 150
    &END MGRID
    &QS
      EPS_DEFAULT 1.0E-12
      EXTRAPOLATION PS
      EXTRAPOLATION_ORDER 1
      &CDFT
        STRENGTH -0.000000000000000000
        TARGET 0.2000
        TYPE_OF_CONSTRAINT BECKE
        &ATOM_GROUP
          ATOMS 1 2
          COEFF 1 -1
        &END ATOM_GROUP
        &BECKE_CONSTRAINT
          CUTOFF_TYPE GLOBAL
          ! 6.0 bohr
          GLOBAL_CUTOFF 3.1750632515399997
        &END BECKE_CONSTRAINT
        &OUTER_SCF
          EPS_SCF 5.0E-3
          MAX_SCF 35
          OPTIMIZER DIIS
          TYPE CDFT_CONSTRAINT
        &END OUTER_SCF
      &END CDFT
    &END QS
    &SCF
      EPS_SCF 5.0E-5
      MAX_SCF 70
      SCF_GUESS ATOMIC
      &OT
        PRECONDITIONER FULL_SINGLE_INVERSE
      &END OT
      &OUTER_SCF ON
        EPS_SCF 5.0E-5
        MAX_SCF 2
      &END OUTER_SCF
    &END SCF
    &XC
      &XC_FUNCTIONAL PADE
      &END XC_FUNCTIONAL
    &END XC
  &END DFT
  &SUBSYS
    &CELL
      ABC 3.00 3.0 3.0
    &END CELL
    &COORD
      H        -3.0000065198  0.0  0.0
      H         -4.03001433862  0.0 0.0
    &END COORD
    &KIND C
      BASIS_SET DZVP-GTH-BLYP
      POTENTIAL GTH-PADE-q4
    &END KIND
    &KIND H
      BASIS_SET DZVP-GTH-BLYP
      POTENTIAL GTH-PADE-q1
    &END KIND
    &KIND O
      BASIS_SET DZVP-GTH-BLYP
      POTENTIAL GTH-PADE-q6
    &END KIND
  &END SUBSYS
&END FORCE_EVAL

! Force_eval B
&FORCE_EVAL
  METHOD Quickstep
  &DFT
    BASIS_SET_FILE_NAME BASIS_SET
    POTENTIAL_FILE_NAME POTENTIAL
    UKS
    &MGRID
      CUTOFF 150
    &END MGRID
    &QS
      EPS_DEFAULT 1.0E-12
      EXTRAPOLATION PS
      EXTRAPOLATION_ORDER 1
      &CDFT
        STRENGTH -0.000000000000000000
        TARGET -0.2000
        TYPE_OF_CONSTRAINT BECKE
        &ATOM_GROUP
          ATOMS 1 2
          COEFF 1 -1
        &END ATOM_GROUP
        &BECKE_CONSTRAINT
          CUTOFF_TYPE GLOBAL
          ! 6.0 bohr
          GLOBAL_CUTOFF 3.1750632515399997
        &END BECKE_CONSTRAINT
        &OUTER_SCF
          EPS_SCF 5.0E-3
          MAX_SCF 35
          OPTIMIZER DIIS
          TYPE CDFT_CONSTRAINT
        &END OUTER_SCF
      &END CDFT
    &END QS
    &SCF
      EPS_SCF 5.0E-5
      MAX_SCF 70
      SCF_GUESS ATOMIC
      &OT
        PRECONDITIONER FULL_SINGLE_INVERSE
      &END OT
      &OUTER_SCF ON
        EPS_SCF 5.0E-5
        MAX_SCF 2
      &END OUTER_SCF
    &END SCF
    &XC
      &XC_FUNCTIONAL PADE
      &END XC_FUNCTIONAL
    &END XC
  &END DFT
  &SUBSYS
    &CELL
      ABC 3.00 3.0 3.0
    &END CELL
    &COORD
      H        -3.0000065198  0.0  0.0
      H         -4.03001433862  0.0 0.0
    &END COORD
    &KIND C
      BASIS_SET DZVP-GTH-BLYP
      POTENTIAL GTH-PADE-q4
    &END KIND
    &KIND H
      BASIS_SET DZVP-GTH-BLYP
      POTENTIAL GTH-PADE-q1
    &END KIND
    &KIND O
      BASIS_SET DZVP-GTH-BLYP
      POTENTIAL GTH-PADE-q6
    &END KIND
  &END SUBSYS
&END FORCE_EVAL
